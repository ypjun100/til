# 선언적 환경 레코드와 this 바인딩

* 이 과정에서는 실행 컨텍스트의 렉시컬 스코프 관점에서 식별자를 검색하는 과정중 일부를 자세히 설명함

![Pasted image 20250215120545](https://github.com/user-attachments/assets/4500fd15-e44a-47b5-ae52-6704c757694c)

### 선언적 환경 레코드 생성

* `var` 키워드로 선언한 전역 변수 및 함수외의 `let`, `const` 변수는 선언적 환경 레코드에 등록되어 관리됨
* 위 사진의 전역 변수 `y`는 `let`, `const`로 선언된 변수로 전역 변수의 객체가 되지 않고 따로 존재하게 됨
* 또한, `let`, `const` 변수는 '선언 단계'와 '초기화 단계'가 분리되어 진행되어 **일시적 사각지대**에 빠지게 됨
* 사진의 `<uninitialized>`는 초기화 단계가 진행되지 않아 변수에 접근할 수 없음을 나타내기 위한 표현

```js
let foo = 1; // 전역 변수

{
	// let, const 키워드로 선언한 변수가 호이스팅되지 않는다면 전역 변수를 참조해야 함
	// 하지만, let 키워드로 선언한 변수도 호이스팅이 발생하여 참조 에러가 발생함
	console.log(foo); // -> ReferenceError: Cannot access 'foo' before init...
	let foo = 2; // 지역 변수
}
```

* `let`, `const` 키워드로 선언한 변수도 `var` 키워드로 선언된 변수와 동일하게 변수 호이스팅이 발생됨
	* 단, 런타임에 변수 선언문 도달 전까지 일시적 사각 지대 (TDZ)에 빠지게 되어 참조할 수 없음

### this 바인딩

* `this`는 전역 객체를 가리키므로 전역 환경 레코드의 `[[GlobalThisValue]]`에 전역 객체가 바인딩됨
* 따라서, 전역 코드에서 `this`를 참조하면 전역 환경 레코드의 내부 슬롯에 바인딩되어 있는 객체가 반환됨

![Pasted image 20250215123427](https://github.com/user-attachments/assets/7aa74bd8-a35d-49cb-845b-724587380c4c)

> 전역 환경 레코드를 구성하는 객체 환경 레코드와 선언적 환경 레코드에는 `this` 바인딩이 없으며, `this` 바인딩은 오직 전역 환경 레코드와 함수 환경 레코드에만 존재한다. 함수 환경 레코드의 위 이미지와 같이 경우 실행 컨텍스트 스택에 별도의 실행 컨텍스트가 쌓이는 형태로 `this` 바인딩을 진행하게 된다.