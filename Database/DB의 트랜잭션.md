# DB의 트랜잭션

* 트랜잭션이란 **DB의 상태를 변경시키기 위해 수행되어야 할 연산을 모아놓은 작업의 단위**
* 모든 연산들을 처리하지 못한 경우, 기존 상태로 복구함 (작업의 일부만 적용되는 경우가 발생하지 않도록)
* 이를 통해 트랜잭션은 작업의 안전성을 보장해줄 수 있음

### 트랜잭션의 성질 ACID
* **Atomicity(원자성)**
	* 트랜잭션은 DB에 모두 반영되든지, 아니면 전혀 반영되지 않아야 함
	* 트랜잭션 내의 모든 명령은 완벽히 수행되어야 하며, 오류가 발생하면 트랜잭션 전부가 취소되어야 함
* **Consistency(일관성)**
	* 트랜잭션의 작업 처리 결과는 항상 일관성 있어야 함
	* 즉, 트랜잭션 전과 후 모두 DB의 제약조건을 준수해야 하며, 제약조건을 위배하는 작업은 수행 불가함
	* 예를 들어 트랜잭션 과정 중에서 특정 필드의 데이터 타입을 변경할 수 없음
* **Isolation(독립성)**
	* 트랜잭션이 병렬로 실행되는 경우, 특정 트랜잭션 실행 중에 다른 트랜잭션의 연산이 침범할 수 없음
	* 수행 중인 트랜잭션이 완전히 종료될 때까지 다른 트랜잭션은 수행 결과를 참조할 수 없음
* **Durability(영속성)**
	* 성공적으로 완료된 트랜잭션의 결과는 시스템이 고장나더라도 영구적으로 반영되어야 함

### 트랜잭션의 연산
* **Commit 연산**
	* 트랜잭션의 수행이 성공적으로 완료되었음을 선언하고, 그 결과를 DB에 반영하는 연산
* **Rollback 연산**
	* 트랜잭션 연산 중 어느 하나가 비정상적으로 작동하여 트랜잭션의 일관성을 깨뜨렸을 때 수행하는 연산
	* 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소함
	* Rollback시에는 해당 트랜잭션을 재시작하거나 폐기할 수 있음

### 트랜잭션의 상태
![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F999C55345B6D2ED308)

* `활동(Active)` : 트랜잭션이 실행 중인 상태
* `실패(Failed)` : 트랜잭션 실행에 오류가 발생하여 중단된 상태
* `철회(Aborted)` : 트랜잭션의 연산이 실패하여 Rollback 연산을 수행한 상태
* `부분 완료(Partially Committed)` : 트랜잭션의 마지막 SQL문이 수행되고, 커밋 연산만 남은 상태
* `완료(Committed)` : 트랜잭션이 성공적으로 종료되어, 커밋 연산을 실행한 후의 상태