# 스키마 설계 패턴

### 다형성 패턴

* 컬렉션 내의 모든 도큐먼트가 유사하지만 모두 동일하지는 않은 도큐먼트 구조를 가질 때 적합한 설계 패턴
* 공통 쿼리로 다양한 도큐먼트들의 타입을 특정하기 위해 도큐먼트 내에 특정 필드를 추가시킬 수 있음
* 추가한 필드를 추적하여 쿼리를 통해 가져온 도큐먼트가 어떤 타입의 도큐먼트인지 특정할 수 있음

### 속성 패턴

```json
{
  "productId": "123",
  "name": "Laptop",
  "attributes": [
    { "name": "cpu", "value": "Intel i7" },
    { "name": "ram", "value": "16GB" },
    { "name": "storage", "value": "512GB SSD" },
    { "name": "os", "value": "Windows 11" }
  ]
}
```

* 속성 패턴은 동일한 컬렉션의 다양한 속성을 가진 엔티티를 유연하게 설계하고자 할 때 주로 사용되는 패턴
* 속성 종류와 개수가 유동적인 경우, 각각을 컬럼으로 만들지 않고 속성을 배열이나 객체로 추상화하여 저장함
* 예시로, 위 예시와 같이 구성한다면, 굳이 컴퓨터뿐만 아니라 다양한 상품들에 대한 속성값을 저장가능함

### 버킷 패턴

```json
{
  "deviceId": "sensor-001",
  "date": "2025-05-29",
  "readings": [
    { "timestamp": "12:00:00", "temperature": 22.5 },
    { "timestamp": "12:00:01", "temperature": 22.7 },
    { "timestamp": "12:00:02", "temperature": 22.6 },
    ...
  ]
}
```

* 대량의 유사한 데이터를 개별 문서로 저장하지 않고, 일정한 기준에 따라 버킷에 묶어서 저장하는 방식
* 몽고DB와 같은 문서형 DB에서 대용량 데이터를 효과적으로 저장하고, 조회 성능을 높이기 위해 사용됨
* 하나의 버킷에 데이터를 묶어 저장하므로, 문서 수가 줄어들고, 조회 시 디스크 I/O가 줄어 성능이 향상됨