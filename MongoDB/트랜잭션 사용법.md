# 트랜잭션 사용법

* 트랜잭션 사용을 위해 관계형 DB와 유사한 구문을 가진 코어 API와 일반적인 방식인 콜백 API이 제공됨
* 코어 API는 대부분의 오류에 재시도 로직을 제공하지 않으며, 커밋 함수 및 오류 함수를 직접 작성해야 함
* 콜백 API는 트랜잭션 시작, 커밋을 포함한 오류 처리 로직을 포함하며, 코어 API를 래핑하는 함수를 제공함
	* 트랜잭션을 통한 애플리케이션 개발을 단순화하며, 트랙잭션 오류 재시도 로직을 쉽게 추가할 수 있음

### 논리 세션

| 구분    | 클라이언트 세션                           | 서버 세션                   |
| ----- | ---------------------------------- | ----------------------- |
| 위치    | 클라리언트 애플리케이션 (드라이버)                | 몽고DB 서버 내부              |
| 역할    | 트랜잭션 관리, 일관성 유지 요청                 | 세션 ID 추적, 복제/일관성 보장     |
| 연결 방식 | 세션 ID를 지정하여 서버에 요청                 | 해당 세션 ID를 기반으로 세션 상태 유지 |
| 수명    | 클라이언트에서 직접 종료하거나,<br>일정 시간 미사용시 만료 | 일정 시간 비활성 시 서버에서 자동 제거  |

* 몽고DB의 논리 세션은 다시 쓰기(rewrite)와 인과적 일관성을 지원하기 위해 사용하는 프레임워크의 일부임
	* 인과적 일관성은 트랜잭션 이전과 이후의 관계가 항상 보장되도록 읽기와 쓰기 순서를 유지하는 모델임
	* 논리 세션은 다른 말로 서버 세션이라고도 하며, 클라리언트 세션에서 사용하는 프레임워크의 일부임
* 두 API 모두 개발자가 트랜잭션에 사용될 논리 세션을 직접 시작한 뒤에 이를 트랜잭션 작업에 연결해야 함
* 인과관계가 반영된 읽기 및 쓰기 작업의 시퀀스는 몽고DB에서 인과관계가 있는 클라이언트 세션으로 정의됨
* 클라이언트 세션은 애플리케이션에 의해 시작되며, 서버 세션과 상호작용하는 데 사용됨