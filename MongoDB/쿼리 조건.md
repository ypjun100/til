# 쿼리 조건

### 쿼리 조건절

```shell
# 18세에서 30세 사이의 사용자를 검색함
> db.users.find({ "age": { "$gte": 18, "$lte": 30 } })

# 2007/01/01 이전에 등록한 사람을 검색함
> db.users.find({ "registered": { "$lt": new Date("01/01/2007") } })

# 사용자명이 "joe"가 아닌 사용자를 검색함
> db.users.find({ "username": { "$ne": "joe" } })

# 사용자 중에 MBTI 키가 존재하고, MBTI가 ISFJ인 사용자를 검색함
> db.users.find({ "mbti": { "$eq": "ISFJ", "$exists": true } })
> 
```

* `<`, `<=`, `>`, `>=`에 해당하는 비교 연산자는 `$lt`, `$lte`, `$gt`, `$gte`이며, 특정 범위 지정도 가능함
* 범위 쿼리는 날짜 쿼리에 유용하며, 날짜는 밀리초 단위로 저장되기 때문에 일치 연산자는 유용하지 않음
* 키 값이 특정 값과 일치하지 않는 도큐먼트를 찾기 위해서는 `$ne` 연산자를 사용함
* 동일 연산자의 경우 `$eq`로도 사용할 수 있으며, 키의 존재유무는 `$exits`로 확인할 수 있음

### OR 쿼리

```shell
# 티켓 번호가 725, 542, 390 중에 하나인 것을 검색함
> db.raffle.find({ "ticket_no": { "$in": [725, 542, 390] } })

# 티켓 번호가 725, 542, 390이 아닌 것을 검색함
> db.raffle.find({ "ticket_no": { "$nin": [725, 542, 390] } })
```

* 몽고 DB의 `$in`은 하나의 키를 여러 값과 비교하며, `$or`은 여러 키를 주어진 값과 비교하는 연산자임
* `$in` 연산자의 값인 배열 안에는 여러 개의 값이나 서로 다른 데이터형의 원소들을 넣을 수 있음
* `$nin`은 `$in`과 반대로 배열 내 조건과 일치하지 않는 도큐먼트를 반환함

```shell
# 티켓 번호가 725, 542 중에 하나인 것을 검색함
> db.raffle.find({"$or": [{ "ticket_no": 725 }, { "ticket_no": 542 }]})
```

* `$in`과 다르게 `$or`은 찾으려는 값이 아닌 찾으려는 조건들을 입력받지만, `$in`이 비교적 더 효율적임