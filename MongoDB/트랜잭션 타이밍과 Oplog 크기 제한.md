# 트랜잭션 타이밍과 Oplog 크기 제한

* 트랜잭션을 사용할 때 알아야 할 몇 가지 매개변수 중 트랜잭션의 시간과 크기를 제한하는 범주가 존재함
* 시간 제한은 트랜잭션이 실행될 수 있는 시간, 락을 획득하기 위한 시간 등의 최대 실행 시간을 제어함
* 크기를 제한하는 것은 특히 몽고DB의 oplog 항목과 개별 항목에 대해 제한을 설정하는 것임

### 시간 제한

* 트랜잭션의 최대 실행 시간은 기본적으로 1분 이하로, 이는 mongod 인스턴스 레벨에서 제한을 수정 가능함
* 시간이 경과되면 트랜잭션이 만료됐다고 간주하며, 주기적으로 실행되는 정리 프로세스에 의해 중단됨
* 트랜잭션 시간 제한은 코어 API에서 제공하는 `commitTransaction()`에 `maxTimeMS`로 명시 가능함
* 트랜잭션의 작업에 필요한 락을 획득하기 위해 트랜잭션이 대기하는 최대 시간은 기본적으로 5밀리세컨드임
	* `maxTransactionLockRequestTimeoutMillis`에 의해 제어되는 제한을 수정해 늘릴 수 있음
	* 만약 트랜잭션이 이 시간 내에 락을 획득할 수 없으면 트랜잭션은 중단되게 됨

### Oplog 크기 제한

* 몽고DB의 Replica 사용 시 Primary 노드에서 발생한 모든 쓰기 작업은 oplog(Operation Log)에 기록됨
* Secondary 노드들은 이 oplog의 데이터들을 따라가면서 동일한 작업을 DB에 수행해 데이터를 동기화함
* 몽고DB는 쓰기 작업에 필요한 만큼 oplog를 생성하지만, 각각 BSON의 크기 제한인 16MB 이하여야 함